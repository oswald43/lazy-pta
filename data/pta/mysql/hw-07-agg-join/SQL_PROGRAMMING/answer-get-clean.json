[
  {
    "problemSetProblemId": "1986663807999430656",
    "lang": "sql",
    "program": "SELECT s.sno, s.sname, sc.grade\nFROM stu s\nJOIN sc ON s.sno = sc.sno\nWHERE sc.cno = 'C002'\nORDER BY sc.grade DESC\nLIMIT 2;",
    "status": "ACCEPTED"
  },
  {
    "problemSetProblemId": "1986663807999430657",
    "lang": "sql",
    "program": "UPDATE sc\nSET grade = grade * 1.05\nWHERE sno IN (\n    SELECT sno \n    FROM stu \n    WHERE sex = 0  -- 假设sex字段中0表示女生\n)\nAND grade < 75;",
    "status": "ACCEPTED"
  },
  {
    "problemSetProblemId": "1986663807999430658",
    "lang": "sql",
    "program": "DELETE sc\nFROM sc\nJOIN stu ON sc.sno = stu.sno\nJOIN cou ON sc.cno = cou.cno\nWHERE stu.sex = 0  -- 0表示女生（根据表结构定义）\n  AND cou.cname = 'C语言';",
    "status": "ACCEPTED"
  },
  {
    "problemSetProblemId": "1986663807999430659",
    "lang": "sql",
    "program": "SELECT ProductID, ProductName\nFROM products\nWHERE UnitsInStock < UnitsOnOrder;",
    "status": "ACCEPTED"
  },
  {
    "problemSetProblemId": "1986663807999430660",
    "lang": "sql",
    "program": "SELECT \n  ReportsTo AS EmployeeID, \n  COUNT(EmployeeID) AS countSub\nFROM employees\nWHERE ReportsTo IS NOT NULL  -- 排除没有上级的员工（即本身不是下属的情况）\nGROUP BY ReportsTo;  -- 按上级编号分组，统计每个上级的下属数量",
    "status": "ACCEPTED"
  },
  {
    "problemSetProblemId": "1986663807999430661",
    "lang": "sql",
    "program": "SELECT sname\nFROM stu\nWHERE birdate > (\n    SELECT MAX(birdate)\n    FROM stu\n    JOIN major ON stu.mno = major.mno\n    WHERE major.mname = '网络工程'\n);",
    "status": "ACCEPTED"
  },
  {
    "problemSetProblemId": "1986663807999430662",
    "lang": "sql",
    "program": "SELECT sname\nFROM stu\nJOIN major ON stu.mno = major.mno\nWHERE major.mname = '软件工程'\nAND birdate = (\n    SELECT MIN(birdate)\n    FROM stu\n    JOIN major ON stu.mno = major.mno\n    WHERE major.mname = '软件工程'\n);",
    "status": "ACCEPTED"
  },
  {
    "problemSetProblemId": "1986663807999430663",
    "lang": "sql",
    "program": "SELECT \n    cou.cno AS 课程号 ,\n    cou.cname AS 课程名 ,\n    MAX(sc.grade) AS 最高成绩,\n    MIN(sc.grade) AS 最低成绩,\n    AVG(sc.grade) AS 平均成绩\nFROM sc\nJOIN cou ON sc.cno = cou.cno\nGROUP BY cou.cno, cou.cname\nHAVING \n    COUNT(*) > 2\n    AND COUNT(*) = COUNT(sc.grade)   -- 确保无 NULL 成绩\n    AND MIN(sc.grade) > 60;",
    "status": "ACCEPTED"
  },
  {
    "problemSetProblemId": "1986663807999430664",
    "lang": "sql",
    "program": "INSERT INTO stu (sno, sname, sex, nation, pnum, birth, phone, dept)\nSELECT sno, sname, sex, nation, pnum, birth, phone, dept\nFROM student\nWHERE dept = '数计学院';",
    "status": "ACCEPTED"
  },
  {
    "problemSetProblemId": "1986663807999430665",
    "lang": "sql",
    "program": "SELECT g.gid, g.gname, g.price, g.stock\nFROM good g\nLEFT JOIN recorder r ON g.gid = r.gid\nWHERE r.gid IS NULL;",
    "status": "ACCEPTED"
  },
  {
    "problemSetProblemId": "1986663807999430666",
    "lang": "sql",
    "program": "SELECT cno AS 课程号\nFROM sc\nWHERE sno = 'S001'\nAND cno NOT IN (\n    SELECT cno\n    FROM sc\n    WHERE sno = 'S003'\n);",
    "status": "ACCEPTED"
  },
  {
    "problemSetProblemId": "1986663807999430667",
    "lang": "sql",
    "program": "SELECT \n  s.sname AS 姓名,\n  m.mname AS 专业名,\n  SUM(c.credit) AS 总学分\nFROM stu s\nJOIN major m ON s.mno = m.mno\nJOIN sc ON s.sno = sc.sno\nJOIN cou c ON sc.cno = c.cno\nGROUP BY s.sno, s.sname, m.mname\nHAVING \n  COUNT(sc.cno) >= 2  -- 选修课程数不少于2门\n  AND MIN(sc.grade) >= 80;  -- 所有成绩均不低于80分（最低分>=80）",
    "status": "ACCEPTED"
  },
  {
    "problemSetProblemId": "1986663807999430668",
    "lang": "sql",
    "program": "SELECT COUNT(DISTINCT cno) AS 门数\nFROM sc;",
    "status": "ACCEPTED"
  },
  {
    "problemSetProblemId": "1986663807999430669",
    "lang": "sql",
    "program": "SELECT \n  cno AS 课程号,\n  COUNT(sno) AS 选修人数\nFROM sc\nGROUP BY cno\nORDER BY 选修人数 DESC\nLIMIT 3;",
    "status": "ACCEPTED"
  },
  {
    "problemSetProblemId": "1986663807999430670",
    "lang": "sql",
    "program": "SELECT sname\nFROM students\nWHERE sdept = (\n    SELECT sdept\n    FROM students\n    WHERE sname = '陆毅'\n)\nAND sname != '陆毅';  -- 排除陆毅本人",
    "status": "ACCEPTED"
  },
  {
    "problemSetProblemId": "1986663807999430671",
    "lang": "sql",
    "program": "SELECT g.id, g.name\nFROM sh_goods g\nLEFT JOIN sh_goods_comment c ON g.id = c.goods_id\nWHERE c.goods_id IS NULL;",
    "status": "ACCEPTED"
  },
  {
    "problemSetProblemId": "1986663807999430672",
    "lang": "sql",
    "program": "SELECT g.name, c.content\nFROM sh_goods_comment c\nJOIN sh_goods g ON c.goods_id = g.id\nWHERE g.score = 5.00;",
    "status": "ACCEPTED"
  },
  {
    "problemSetProblemId": "1986663807999430673",
    "lang": "sql",
    "program": "SELECT \n  g.id AS gid,\n  g.category_id AS cid,\n  c.name AS cname,\n  g.score AS score\nFROM sh_goods g\nLEFT JOIN sh_goods_category c ON g.category_id = c.id\nWHERE g.score = 5.00;",
    "status": "ACCEPTED"
  },
  {
    "problemSetProblemId": "1986663807999430674",
    "lang": "sql",
    "program": "SELECT\n    name\nFROM\n    sh_goods_category\nWHERE\n    id IN (SELECT category_id FROM sh_goods WHERE price < 500);",
    "status": "ACCEPTED"
  },
  {
    "problemSetProblemId": "1986663807999430675",
    "lang": "sql",
    "program": "SELECT\n    s.sno,\n    s.sname,\n    s.dept\nFROM\n    student AS s\nJOIN\n    (\n        -- 子查询：统计每个学生选修的课程数\n        SELECT\n            sno,\n            COUNT(cno) AS course_num\n        FROM\n            score\n        GROUP BY\n            sno\n    ) AS sc ON s.sno = sc.sno\nWHERE\n    sc.course_num >= 3;",
    "status": "ACCEPTED"
  },
  {
    "problemSetProblemId": "1986663807999430676",
    "lang": "sql",
    "program": "SELECT \n  c.cno,\n  c.cname,\n  COUNT(sc.sno) AS total\nFROM course c\nLEFT JOIN score sc ON c.cno = sc.cno\nWHERE c.attribute = '必修'\nGROUP BY c.cno, c.cname;",
    "status": "ACCEPTED"
  },
  {
    "problemSetProblemId": "1986663807999430677",
    "lang": "sql",
    "program": "SELECT s.sname, s.dept\nFROM student s\nJOIN score sc ON s.sno = sc.sno\nJOIN course c ON sc.cno = c.cno\nWHERE c.cname = '大学语文' AND sc.grade > 80;",
    "status": "ACCEPTED"
  },
  {
    "problemSetProblemId": "1986663807999430678",
    "lang": "sql",
    "program": "SELECT \n  e.empno, \n  e.ename, \n  e.sal, \n  s.grade \nFROM emp e\nJOIN salgrade s ON e.sal BETWEEN s.losal AND s.hisal;",
    "status": "ACCEPTED"
  },
  {
    "problemSetProblemId": "1986663807999430679",
    "lang": "sql",
    "program": "SELECT \n  e.empno AS 员工编号,\n  e.ename AS 员工姓名,\n  m.empno AS 上司编号,\n  m.ename AS 上司姓名\nFROM emp e\nLEFT JOIN emp m ON e.mgr = m.empno;",
    "status": "ACCEPTED"
  },
  {
    "problemSetProblemId": "1986663807999430680",
    "lang": "sql",
    "program": "SELECT d.DepartmentHeader\nFROM Teacher t\nJOIN Department d ON t.DepartmentID = d.DepartmentID\nWHERE t.TeacherID = 'dep01001';",
    "status": "ACCEPTED"
  },
  {
    "problemSetProblemId": "1986663807999430681",
    "lang": "sql",
    "program": "SELECT s.StudentID, s.StudentName, s.Sex\nFROM Student s\nLEFT JOIN Grade g ON s.StudentID = g.StudentID\nWHERE g.StudentID IS NULL;",
    "status": "ACCEPTED"
  },
  {
    "problemSetProblemId": "1986663807999430682",
    "lang": "sql",
    "program": "SELECT \n  s.sno,\n  s.sname,\n  c.cno,\n  c.cname,\n  sc.term,\n  sc.grade\nFROM student s\nJOIN score sc ON s.sno = sc.sno\nJOIN course c ON sc.cno = c.cno;",
    "status": "ACCEPTED"
  },
  {
    "problemSetProblemId": "1986663807999430683",
    "lang": "sql",
    "program": "SELECT \n  s1.sno AS 学号,\n  c.cname AS 课程名,\n  s1.grade AS 成绩\nFROM sc s1\nJOIN cou c ON s1.cno = c.cno  -- 关联课程表获取课程名\nWHERE s1.grade > (\n  SELECT AVG(s2.grade)\n  FROM sc s2\n  WHERE s2.sno = s1.sno  -- 相关子查询：当前学生的平均成绩\n);",
    "status": "ACCEPTED"
  },
  {
    "problemSetProblemId": "1986663807999430684",
    "lang": "sql",
    "program": "SELECT s.sname\nFROM stu s\nWHERE NOT EXISTS (\n  -- 张老师的课程中，该学生未选修的课程\n  SELECT c.cno\n  FROM cou c\n  WHERE c.teacher = '张老师'  -- 筛选张老师讲授的课程\n    AND NOT EXISTS (\n      -- 该学生选修了此课程的记录\n      SELECT sc.cno\n      FROM sc\n      WHERE sc.sno = s.sno \n        AND sc.cno = c.cno\n    )\n);",
    "status": "ACCEPTED"
  },
  {
    "problemSetProblemId": "1986663807999430685",
    "lang": "sql",
    "program": "SELECT c.cno, c.cname\nFROM course c\nLEFT JOIN score sc ON c.cno = sc.cno\nWHERE sc.cno IS NULL;",
    "status": "ACCEPTED"
  },
  {
    "problemSetProblemId": "1986663807999430686",
    "lang": "sql",
    "program": "SELECT \n  sno AS 学号, \n  ROUND(AVG(grade), 1) AS 平均成绩\nFROM score\nGROUP BY sno\nHAVING COUNT(cno) >= 2;",
    "status": "ACCEPTED"
  },
  {
    "problemSetProblemId": "1986663807999430687",
    "lang": "sql",
    "program": "SELECT \n  gid AS 商品编号, \n  SUM(quantity) AS 销售总数量\nFROM recorder\nGROUP BY gid;",
    "status": "ACCEPTED"
  },
  {
    "problemSetProblemId": "1986663807999430688",
    "lang": "sql",
    "program": "SELECT \n  AVG(score) AS 平均分,\n  MAX(score) AS 最高分,\n  MIN(score) AS 最低分\nFROM sc\nWHERE cno = '0000001';",
    "status": "ACCEPTED"
  },
  {
    "problemSetProblemId": "1986663807999430689",
    "lang": "sql",
    "program": "SELECT \n    sno AS 学号,\n    COUNT(cno) AS 选课门数,\n    SUM(score) AS 考试总成绩\nFROM \n    sc\nGROUP BY \n    sno  -- 按学号分组，统计每个学生的信息\nORDER BY \n    选课门数 ASC;  -- 按选课门数升序排列",
    "status": "ACCEPTED"
  },
  {
    "problemSetProblemId": "1986663807999430690",
    "lang": "sql",
    "program": "SELECT keyword, COUNT(id) AS goodscount\nFROM sh_goods\nGROUP BY keyword;",
    "status": "ACCEPTED"
  },
  {
    "problemSetProblemId": "1986663807999430691",
    "lang": "sql",
    "program": "SELECT category_id, MAX(price) AS max_price\nFROM sh_goods\nGROUP BY category_id;",
    "status": "ACCEPTED"
  },
  {
    "problemSetProblemId": "1986663807999430692",
    "lang": "sql",
    "program": "SELECT MAX(stock) AS stock1, MIN(stock) AS stock2\nFROM sh_goods;",
    "status": "ACCEPTED"
  },
  {
    "problemSetProblemId": "1986663807999430693",
    "lang": "sql",
    "program": "SELECT category_id, AVG(price) AS average\nFROM sh_goods\nGROUP BY category_id\nHAVING COUNT(*) > 2;",
    "status": "ACCEPTED"
  },
  {
    "problemSetProblemId": "1986663807999430694",
    "lang": "sql",
    "program": "SELECT StudentName, Birth\nFROM Student\nWHERE Birth = (SELECT MAX(Birth) FROM Student);",
    "status": "ACCEPTED"
  },
  {
    "problemSetProblemId": "1986663807999430695",
    "lang": "sql",
    "program": "SELECT ClassID\nFROM Class\nWHERE StudentNum > 5;",
    "status": "ACCEPTED"
  }
]